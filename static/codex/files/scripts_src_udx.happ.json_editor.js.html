<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>scripts/src/udx.happ.json_editor.js - usabilitydynamics/lib-utility</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="usabilitydynamics/lib-utility"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Utility.html">Utility</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/event.html">event</a></li>
            
                <li><a href="../modules/ud.html">ud</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: scripts/src/udx.happ.json_editor.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * JSON Editor
 * It&#x27;s just a wrapper for ud.json.editor
 * - loads ud.json.editor library and styles
 * - adds schema and validation functionality.
 *
 * @required ud.loader, ud.async
 * @author peshkov@UD
 */

Application.define( &#x27;core.json_editor&#x27;, function( args ) {

  /* Set arguments */
  args = jQuery.extend( true, {
    &#x27;container&#x27; : false, // ID of DOM element where editor/formatter will be initialized
    &#x27;instance&#x27; : &#x27;editor&#x27;, // Available value: &#x27;editor&#x27;, &#x27;formatter&#x27;
    &#x27;options&#x27; : {},
    &#x27;json&#x27; : null,
    &#x27;callback&#x27; : function( editor ) { return editor; }, // Object can be got only using callback!
    // Set of actions listeners which are fired on json editor events
    &#x27;actions&#x27; : {
      /**
       * Called on Save event.
       * @param object json
       */
      &#x27;save&#x27;: function( json ) {
        return null;
      },
      /**
       * Called after validation process
       * @param object result Validation&#x27;s response
       */
      &#x27;validate&#x27;: function( result ) {
        return null;
      }
    }
  }, typeof args === &#x27;object&#x27; ? args : {} );

  /* Check container argument */
  var container = typeof args.container === &#x27;object&#x27; ? args.container.get(0) : document.getElementById( args.container.replace( &#x27;#&#x27;, &#x27;&#x27; ) );

  /**
   *
   */
  var editor = function( container, args ) {

    var self = this;

    self._args = typeof args.options == &#x27;object&#x27; ? args.options : {};

    /* */
    self.options = jQuery.extend( true, {
      &#x27;change&#x27; : function() { return null }, // Set a callback method triggered when the contents of the JSONEditor change. Called without parameters.
      &#x27;history&#x27; : true, // Enables history, adds a button Undo and Redo to the menu of the JSONEditor. Only applicable when mode is &#x27;editor&#x27;.
      &#x27;mode&#x27; : &#x27;editor&#x27;, // Set the editor mode. Available values: &#x27;editor&#x27;, &#x27;viewer&#x27;, or &#x27;form&#x27;. In &#x27;viewer&#x27; mode, the data and datastructure is read-only. In &#x27;form&#x27; mode, only the value can be changed, the datastructure is read-only.
      //&#x27;name&#x27; : &#x27;name_&#x27; + ( Math.ceil( Math.random() * 10000 ) ), // Initial field name for the root node. Can also be set using JSONEditor.setName(name)
      &#x27;search&#x27; : true // Enables a search box in the upper right corner of the JSONEditor. True by default.
    }, typeof args.options == &#x27;object&#x27; ? args.options : {} );

    /* */
    self.__ = new JSONEditor (container, self.options, typeof self._args.json != &#x27;undefined&#x27; ? self._args.json : null );

    /* */
    self.schema = false;

    /**
     *
     */
    self.save = function() {
      if( self.schema &amp;&amp; !self.validate() ) {
        return false;
      }
      /* Special Handlers can be added here */
      try { self._args.actions.save( schema.get() ); } catch( error ) { return false; }
      return true;
    }


    /**
     *
     */
    self.set = function ( json, options ) {

      options = jQuery.extend( true, {
        &#x27;name&#x27; : null,
        &#x27;schema&#x27; : null
      }, typeof options === &#x27;object&#x27; ? options : {} );

      self.schema = typeof options.schema === &#x27;object&#x27; &amp;&amp; options.schema != null ? options.schema : false;
      if( self.schema ) {
        jQuery( &#x27;button.jsoneditor-validate-object&#x27;, container ).show();
      } else {
        jQuery( &#x27;button.jsoneditor-validate-object&#x27;, container ).hide();
      }

      if( typeof options.name === &#x27;string&#x27; ) {
        return self.__.set( json, options.name );
      } else {
        return self.__.set( json );
      }

    }

    /**
     *
     */
    self.get = function () {
      console.log( &#x27;JSON EDITOR: GET&#x27; );
      return self.__.get();
    }


    /**
     * Validates the current object if schema is set and returns boolean
     *
     * @uses ud.json.validate
     */
    self.validate = function () {
      if( typeof self.schema !== &#x27;object&#x27; || typeof validate === &#x27;undefined&#x27; ) {
        return true;
      }
      self.last_validation = validate( self.get(), self.schema );
      /* Special Handlers can be added here */
      try { self._args.actions.validate( self.last_validation ); } catch( error ) { return false; }
      return self.last_validation.valid;
    }

    /**
     *
     */
    self._update_menu = function( enable ) {
      var save_button = jQuery( &#x27;button.jsoneditor-save-object&#x27;, container );

      var validate_button = document.createElement( &#x27;button&#x27; );
      validate_button.title = &#x27;Validate&#x27;;
      validate_button.className = &#x27;jsoneditor-menu jsoneditor-validate-object&#x27;;
      validate_button.appendChild( document.createTextNode( &quot;Validate&quot; ) );
      validate_button.style.display = &#x27;none&#x27;;
      validate_button.onclick = function(){ self.validate(); }

      save_button.click( function() { self.save(); } ).after( validate_button );
    }


    /* Add default scope&#x27;s properties to our wrapper */
    jQuery.each( self.__, function( i, e ) {
      if( typeof self[ i ] === &#x27;undefined&#x27; ) {
        self[ i ] = e;
      }
    } );

    self._update_menu();

  };

  /* */
  async.parallel( {
    // Load required scripts
    &#x27;js&#x27; : function( callback ) {

      ud.load.js( {
        &#x27;JSONEditor&#x27; : &#x27;//ud-cdn.com/js/ud.json.editor/latest/ud.json.editor.js&#x27;,
        &#x27;validate&#x27; : &#x27;//ud-cdn.com/js/ud.json.validate/1.0/ud.json.validate.js&#x27;
      }, function() {
        callback( null, true );
      });
    },
    // Loads required CSS if needed
    &#x27;css&#x27; : function( callback ) {
      window._flags = typeof window._flags !== &#x27;undefined&#x27; ? window._flags : {};
      if( typeof window._flags.json_editor_css === &#x27;undefined&#x27; || !window._flags.json_editor_css ) {
        ud.load.css( &#x27;//ud-cdn.com/js/ud.json.editor/latest/assets/ud.json.editor.css&#x27; );
        window._flags.json_editor_css = true;
      }
      callback( null, true );
    }
  }, function( err ) {

    if ( typeof args.callback === &#x27;function&#x27; ) {
      /*  */
      var instance = null;
      switch( args.instance ) {
        case &#x27;editor&#x27;:
          instance = new editor( container, args );
          break;

        case &#x27;formatter&#x27;:
          instance = new JSONformatter ( container, args.options );
          break;
      }
      args.callback( instance );
    }

  } );

} );
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
